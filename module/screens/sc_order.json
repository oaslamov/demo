{
  "code":"sc_order:scr@demo1_prvt",
  "label":"$l{Order}l",
  "subject":"$l{Demo1}l/$l{Order}l",
  "title":"$l{Order}l # ${shipping_order.id}",
  "sort_order":"Z30.1",
  "grid":{
    "base":"screen",
    "cols":16,
    "rows":16
  },
  "data_sources":[
    {
      "code":"shipping_order",
      "table_name":"Demo1_Prvt.Shipping_Order",
      "type":"table",
      "fields":[
        {
          "code":"comment",
          "label":"$l{f:7ef07d00800a}l",
          "type":"text",
          "edit_condition":"false",
          "hint":"$l{f:7ef07d00800a:d}l"
        },
        {
          "code":"customer",
          "label":"$l{f:7ef07d008006}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Customer"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d008006:d}l"
        },
        {
          "code":"date_order_paid",
          "label":"$l{f:7ef07d008009}l",
          "type":"plaindate",
          "hint":"$l{f:7ef07d008009:d}l"
        },
        {
          "code":"datetime_order_placed",
          "label":"$l{f:7ef07d008008}l",
          "type":"datetime",
          "hint":"$l{f:7ef07d008008:d}l"
        },
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"shipment_date",
          "label":"$l{f:7ef07d00800b}l",
          "type":"plaindate",
          "hint":"$l{f:7ef07d00800b:d}l"
        },
        {
          "code":"total",
          "label":"$l{f:7ef07d00800e}l",
          "type":"number",
          "edit_condition":"false",
          "hint":"$l{f:7ef07d00800e:d}l"
        }
      ],
      "operations":{
        "new":{
          "request":{
            "data":{
              "action":"demo1_prvt.new",
              "args":{
                "tablename":"demo1_prvt.shipping_order"
              }
            }
          }
        },
        "select":{
          "request":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@user_filter}",
                  "${@screen.filter}",
                  "order by datetime_order_placed desc"
                ],
                "tablename":"demo1_prvt.shipping_order"
              }
            }
          }
        },
        "insert":{
          "request":{
            "data":{
              "action":"demo1_prvt.insert",
              "args":{
                "tablename":"demo1_prvt.shipping_order",
                "fields":"${@all_fields}"
              }
            }
          }
        },
        "update":{
          "request":{
            "data":{
              "action":"demo1_prvt.update",
              "args":{
                "tablename":"demo1_prvt.shipping_order",
                "fields":"${@all_fields}"
              }
            }
          }
        },
        "delete":{
          "request":{
            "data":{
              "action":"demo1_prvt.deleteById",
              "args":{
                "id":"${id}",
                "tablename":"demo1_prvt.shipping_order"
              }
            }
          }
        }
      },
      "actions":[
        {
          "code":"choose_customer",
          "icon":"fas fa-search",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"sc_choose_customer:scr@demo1_prvt",
                "mode":"popup",
                "args":{
                  "field":"customer",
                  "id":"${shipping_order.id}",
                  "tableName":"demo1_prvt.shipping_order"
                }
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        {
          "code":"edit_comment",
          "label":"$l{Edit comment}l",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"sc_edit_order_comment:scr@demo1_prvt",
                "args":{
                  "id":"${id}"
                },
                "mode":"popup"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        {
          "code":"edit_richtext",
          "icon":"fas fa-edit",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"dyn:richtext_popup:demo1_prvt.shipping_order:comment:${id}:scr@demo1_prvt",
                "args":"",
                "mode":"popup"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        {
          "code":"select_customer",
          "icon":"fas fa-search-plus",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "args":"",
                "mode":"selector",
                "screenId":"demo1_customer:scr@demo1_prvt"
              }
            }
          },
          "target":{
            "ds":"shipping_order",
            "field":"customer",
            "mode":"replace"
          },
          "enable_condition":"${@e.is_order_selected}"
        }
      ]
    },
    {
      "code":"shipping_order_product",
      "table_name":"Demo1_Prvt.Shipping_Order_Product",
      "type":"table",
      "fields":[
        {
          "code":"comment",
          "label":"$l{f:7ef07d00900b}l",
          "type":"string",
          "hint":"$l{f:7ef07d00900b:d}l"
        },
        {
          "code":"id",
          "label":"$l{Id}l",
          "type":"string",
          "edit_condition":"false"
        },
        {
          "code":"product",
          "label":"$l{f:7ef07d009008}l",
          "type":"ref",
          "mandatory":true,
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Product"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d009008:d}l"
        },
        {
          "code":"quantity",
          "label":"$l{f:7ef07d00900a}l",
          "type":"integer",
          "mandatory":true,
          "hint":"$l{f:7ef07d00900a:d}l"
        },
        {
          "code":"shipping_order",
          "label":"$l{f:7ef07d009006}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Shipping_Order"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d009006:d}l"
        },
        {
          "code":"price",
          "label":"$l{f:7ef07d009011}l",
          "type":"number",
          "edit_condition":"false",
          "hint":"$l{f:7ef07d009011:d}l",
          "placeholder":"$l{Get price from Product table if blank}l"
        },
        {
          "code":"sum",
          "label":"$l{f:7ef07d009012}l",
          "type":"number",
          "edit_condition":"false",
          "hint":"$l{f:7ef07d009012:d}l",
          "placeholder":"$l{Auto calculate}l"
        },
        {
          "code":"item_order",
          "label":"$l{f:7ef07d009013}l",
          "type":"float64",
          "edit_condition":"false",
          "hint":"$l{f:7ef07d009013:d}l"
        }
      ],
      "operations":{
        "new":{
          "request":{
            "data":{
              "action":"demo1_prvt.new",
              "args":{
                "tablename":"demo1_prvt.shipping_order_product",
                "fields":{
                  "Shipping_Order":"${shipping_order.id}"
                }
              }
            }
          },
          "enable_condition":"${@e.is_order_selected}"
        },
        "select":{
          "request":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${shipping_order.id}=Shipping_Order"
                ],
                "tablename":"demo1_prvt.shipping_order_product"
              }
            },
            "dependencies":[
              "shipping_order.id"
            ]
          }
        },
        "insert":{
          "request":{
            "data":{
              "action":"demo1_prvt.insert",
              "args":{
                "tablename":"demo1_prvt.shipping_order_product",
                "fields":"${@all_fields}"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        "update":{
          "request":{
            "data":{
              "action":"demo1_prvt.update",
              "args":{
                "tablename":"demo1_prvt.shipping_order_product",
                "fields":"${@all_fields}"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ]
        },
        "delete":{
          "request":{
            "data":{
              "action":"demo1_prvt.deleteById",
              "args":{
                "id":"${id}",
                "tablename":"demo1_prvt.shipping_order_product"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ]
        }
      },
      "actions":[
        {
          "code":"new_item",
          "label":"$l{Add item}l",
          "data_scope":"none",
          "icon":"fa fa-plus-square",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"sc_new_order_item:scr@demo1_prvt",
                "args":{
                  "order_id":"${shipping_order.id}"
                },
                "mode":"popup"
              }
            }
          },
          "freshen":[
            {
              "code":"shipping_order_product",
              "type":"all_rows"
            },
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        {
          "code":"edit_items",
          "label":"$l{Edit items}l",
          "data_scope":"none",
          "icon":"fas fa-edit",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"sc_edit_order_items:scr@demo1_prvt",
                "args":{
                  "order_id":"${shipping_order.id}"
                },
                "mode":"popup"
              }
            },
            "dependencies":[
              "@action.shipping_order:insert"
            ]
          },
          "freshen":[
            {
              "code":"shipping_order_product",
              "type":"all_rows"
            },
            {
              "code":"shipping_order",
              "type":"current_row"
            }
          ],
          "enable_condition":"${@e.is_order_selected}"
        },
        {
          "code":"up",
          "label":"$l{Up}l",
          "type":"update",
          "icon":"fas fa-arrow-up",
          "request":{
            "data":{
              "action":"demo1_prvt.updateRowOrder",
              "args":{
                "isFast":"${@special.ctrlkey}",
                "query":"shipping_order=${shipping_order.id}",
                "orderFieldName":"item_order",
                "fields":"${@all_fields}",
                "isDown":"false",
                "tableName":"demo1_prvt.shipping_order_product"
              }
            }
          },
          "freshen":[
            {
              "type":"all_rows"
            }
          ]
        },
        {
          "code":"down",
          "label":"$l{Down}l",
          "type":"update",
          "icon":"fas fa-arrow-down",
          "request":{
            "data":{
              "action":"demo1_prvt.updateRowOrder",
              "args":{
                "isFast":"${@special.ctrlkey}",
                "query":"shipping_order=${shipping_order.id}",
                "orderFieldName":"item_order",
                "fields":"${@all_fields}",
                "isDown":"true",
                "tableName":"demo1_prvt.shipping_order_product"
              }
            }
          },
          "freshen":[
            {
              "type":"all_rows"
            }
          ]
        }
      ]
    },
    {
      "code":"customer",
      "table_name":"Demo1_Prvt.Customer",
      "type":"table",
      "fields":[
        {
          "code":"address_line1",
          "label":"$l{f:7ef07d006008}l",
          "type":"string",
          "hint":"$l{f:7ef07d006008:d}l"
        },
        {
          "code":"address_line2",
          "label":"$l{f:7ef07d006009}l",
          "type":"string",
          "hint":"$l{f:7ef07d006009:d}l"
        },
        {
          "code":"address_line3",
          "label":"$l{f:7ef07d00600a}l",
          "type":"string",
          "hint":"$l{f:7ef07d00600a:d}l"
        },
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"mobile",
          "label":"$l{f:7ef07d00600b}l",
          "type":"string",
          "hint":"$l{f:7ef07d00600b:d}l"
        },
        {
          "code":"name",
          "label":"$l{f:7ef07d006006}l",
          "type":"string",
          "hint":"$l{f:7ef07d006006:d}l"
        },
        {
          "code":"phone",
          "label":"$l{f:7ef07d006007}l",
          "type":"string",
          "hint":"$l{f:7ef07d006007:d}l"
        },
        {
          "code":"city",
          "label":"$l{f:7ef07d006010}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.City"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d006010:d}l"
        },
        {
          "code":"country",
          "label":"$l{f:7ef07d00600c}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Country"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d00600c:d}l"
        },
        {
          "code":"subcountry",
          "label":"$l{f:7ef07d00600e}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Subcountry"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d00600e:d}l"
        }
      ],
      "operations":{
        "select":{
          "request":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "id=${shipping_order.customer}"
                ],
                "tablename":"demo1_prvt.customer"
              }
            },
            "dependencies":[
              "shipping_order.customer"
            ]
          }
        }
      },
      "actions":[
        {
          "code":"ac_c_det",
          "label":"$l{Details}l",
          "request":{
            "data":{
              "action":"gui.goScreen",
              "args":{
                "screenId":"demo1_c_details:scr@demo1_prvt",
                "args":{
                  "id":"${customer.id}"
                },
                "mode":"popup"
              }
            }
          },
          "freshen":[
            {
              "code":"customer",
              "type":"current_row"
            }
          ],
          "hint":"$l{Opens in a popup window}l"
        },
        {
          "code":"internetSearch",
          "icon":"fab fa-google",
          "request":{
            "data":{
              "action":"gui.goLink",
              "args":{
                "newWindow":"true",
                "url":"www.google.com/search?q=${(-q)customer.name}"
              }
            }
          },
          "hint":"$l{Search in Google}l"
        },
        {
          "code":"mapSearch",
          "icon":"fas fa-search-location",
          "request":{
            "data":{
              "action":"gui.goLink",
              "args":{
                "newWindow":"true",
                "url":"https://maps.google.com/maps?q=${(-q)customer.address_line2}"
              }
            }
          },
          "hint":"$l{Show on Google Maps}l"
        }
      ]
    }
  ],
  "expressions":[
    {
      "code":"show_city_info",
      "text":"${customer.city}!=null"
    },
    {
      "code":"is_order_selected",
      "text":"${shipping_order.id}!=null"
    }
  ],
  "parts":[
    {
      "code":"p_list",
      "label":"$l{Order list}l",
      "type":"table",
      "border_type":"none",
      "position":{
        "from_col":1,
        "to_col":5,
        "from_row":1,
        "to_row":16
      },
      "data_source":{
        "code":"shipping_order",
        "fields":[
          {
            "code":"datetime_order_placed",
            "width":"40%"
          },
          {
            "code":"customer"
          },
          {
            "code":"id",
            "view_condition":"false"
          },
          {
            "code":"total",
            "view":"t"
          }
        ],
        "order":[
          {
            "field":"datetime_order_placed"
          }
        ],
        "operations":[
          "new",
          "select",
          "insert",
          "update",
          "delete"
        ]
      }
    },
    {
      "code":"p_header",
      "label":"$l{Order}l # ${shipping_order.id}",
      "type":"form",
      "border_type":"none",
      "position":{
        "from_col":6,
        "to_col":16,
        "from_row":1,
        "to_row":3
      },
      "data_source":{
        "code":"shipping_order",
        "fields":[
          {
            "code":"shipment_date"
          },
          {
            "code":"customer"
          }
        ],
        "operations":[
          "select"
        ]
      }
    },
    {
      "code":"p_item",
      "label":"$l{Order items}l",
      "type":"table",
      "border_type":"none",
      "position":{
        "from_col":6,
        "to_col":16,
        "from_row":10,
        "to_row":16
      },
      "data_source":{
        "code":"shipping_order_product",
        "fields":[
          {
            "code":"product",
            "width":"30%"
          },
          {
            "code":"quantity"
          },
          {
            "code":"price",
            "view":"t"
          },
          {
            "code":"sum",
            "view":"t"
          },
          {
            "code":"comment",
            "view":"t"
          },
          {
            "code":"item_order",
            "filter_view":1,
            "view_condition":"false"
          }
        ],
        "order":[
          {
            "field":"item_order"
          }
        ],
        "operations":[
          "new",
          "select",
          "insert",
          "update",
          "delete"
        ],
        "actions":[
          "new_item",
          "edit_items",
          "up",
          "down"
        ]
      }
    },
    {
      "code":"t_details",
      "type":"tabs",
      "border_type":"none",
      "position":{
        "from_col":6,
        "to_col":16,
        "from_row":4,
        "to_row":9
      },
      "data_source":{
      },
      "sub_parts":[
        {
          "code":"c_summary",
          "label":"$l{Order summary}l",
          "type":"container",
          "border_type":"none",
          "position":{
            "from_col":6,
            "to_col":16,
            "from_row":4,
            "to_row":9
          },
          "sub_parts":[
            {
              "code":"p_summary_1",
              "type":"form",
              "border_type":"none",
              "position":{
                "from_col":6,
                "to_col":10,
                "from_row":4,
                "to_row":9
              },
              "data_source":{
                "code":"shipping_order",
                "fields":[
                  {
                    "code":"customer",
                    "actions":[
                      "select_customer"
                    ]
                  },
                  {
                    "code":"shipment_date"
                  },
                  {
                    "code":"date_order_paid"
                  },
                  {
                    "code":"datetime_order_placed"
                  }
                ],
                "operations":[
                  "select",
                  "update",
                  "delete",
                  "insert",
                  "new"
                ]
              }
            },
            {
              "code":"p_summary_2",
              "type":"form",
              "border_type":"none",
              "position":{
                "from_col":11,
                "to_col":16,
                "from_row":4,
                "to_row":9
              },
              "data_source":{
                "code":"shipping_order",
                "fields":[
                  {
                    "code":"total"
                  }
                ],
                "operations":[
                  "select",
                  "update"
                ]
              }
            }
          ]
        },
        {
          "code":"c_customer",
          "label":"$l{Billing}l",
          "type":"container",
          "border_type":"none",
          "position":{
            "from_col":6,
            "to_col":16,
            "from_row":4,
            "to_row":9
          },
          "sub_parts":[
            {
              "code":"p_customer_1",
              "type":"form",
              "border_type":"none",
              "position":{
                "from_col":6,
                "to_col":10,
                "from_row":4,
                "to_row":9
              },
              "data_source":{
                "code":"customer",
                "fields":[
                  {
                    "code":"fg_c",
                    "label":"$l{Customer}l",
                    "type":"group"
                  },
                  {
                    "code":"name",
                    "group":"fg_c",
                    "actions":[
                      "internetSearch"
                    ]
                  },
                  {
                    "code":"fg_p",
                    "label":"$l{Contacts}l",
                    "type":"group"
                  },
                  {
                    "code":"phone",
                    "group":"fg_p"
                  },
                  {
                    "code":"mobile",
                    "group":"fg_p"
                  }
                ],
                "operations":[
                  "select"
                ],
                "actions":[
                  "ac_c_det"
                ]
              }
            },
            {
              "code":"p_customer_2",
              "type":"form",
              "border_type":"none",
              "position":{
                "from_col":11,
                "to_col":16,
                "from_row":4,
                "to_row":9
              },
              "data_source":{
                "code":"customer",
                "fields":[
                  {
                    "code":"fg_a",
                    "label":"$l{Address}l",
                    "type":"group"
                  },
                  {
                    "code":"address_line1",
                    "group":"fg_a"
                  },
                  {
                    "code":"address_line2",
                    "group":"fg_a",
                    "actions":[
                      "mapSearch"
                    ]
                  },
                  {
                    "code":"address_line3",
                    "group":"fg_a"
                  },
                  {
                    "code":"country",
                    "group":"fg_a",
                    "view_condition":"${@e.show_city_info}"
                  },
                  {
                    "code":"subcountry",
                    "group":"fg_a",
                    "view_condition":"${@e.show_city_info}"
                  },
                  {
                    "code":"city",
                    "group":"fg_a",
                    "view_condition":"${@e.show_city_info}"
                  }
                ],
                "operations":[
                  "select"
                ]
              }
            }
          ]
        },
        {
          "code":"c_comment",
          "label":"$l{Comment}l",
          "type":"container",
          "border_type":"none",
          "position":{
            "from_col":6,
            "to_col":16,
            "from_row":4,
            "to_row":9
          },
          "sub_parts":[
            {
              "code":"p_order_comment",
              "type":"form",
              "border_type":"none",
              "position":{
                "from_col":6,
                "to_col":16,
                "from_row":4,
                "to_row":9
              },
              "data_source":{
                "code":"shipping_order",
                "fields":[
                  {
                    "code":"comment"
                  }
                ],
                "operations":[
                  "select",
                  "update"
                ],
                "actions":[
                  "edit_comment"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
