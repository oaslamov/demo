{
  "code":"demo1_p_details:scr@demo1_prvt",
  "label":"$l{Product details}l",
  "serverStatus":"r",
  "subject":"$l{Demo1}l",
  "show_in_menu":false,
  "args":[
    {
      "code":"product_id",
      "is_mandatory":true
    },
    {
      "code":"product_name",
      "is_mandatory":true
    }
  ],
  "grid":{
    "base":"screen",
    "cols":4,
    "rows":4
  },
  "width":"70",
  "data_sources":[
    {
      "code":"ds_img",
      "table_name":"Demo1_Prvt.Product_Det",
      "type":"table",
      "fields":[
        {
          "code":"format",
          "label":"$l{f:7ef07d020009}l",
          "type":"string",
          "hint":"$l{f:7ef07d020009:d}l"
        },
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"img",
          "label":"$l{f:7ef07d020008}l",
          "type":"bytes",
          "hint":"$l{f:7ef07d020008:d}l"
        },
        {
          "code":"product",
          "label":"$l{f:7ef07d020006}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Product"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d020006:d}l"
        }
      ],
      "operations":{
        "select":{
          "request":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "product=${@screen.product_id}"
                ],
                "tablename":"demo1_prvt.product_det"
              }
            }
          }
        }
      },
      "actions":[
        {
          "code":"upload_image",
          "label":"$l{Upload image}l",
          "type":"file_upload",
          "data_scope":"none",
          "request":{
            "data":{
              "action":"demo1_prvt.uploadProductImage",
              "args":{
                "fileTime":"${@filetime}",
                "fileName":"${@name}",
                "fileBytes":"${@bytes}",
                "rowID":"${@screen.product_id}"
              }
            }
          },
          "freshen":[
            {
              "code":"ds_img",
              "type":"all_rows"
            }
          ]
        },
        {
          "code":"delete_image",
          "label":"$l{Delete image}l",
          "data_scope":"row",
          "confirm":true,
          "request":{
            "data":{
              "action":"demo1_prvt.deleteProductImage",
              "args":{
                "rowID":"${ds_img.product}"
              }
            }
          },
          "freshen":[
            {
              "code":"ds_img",
              "type":"current_row"
            }
          ]
        },
        {
          "code":"download_image",
          "label":"$l{Download image}l",
          "data_scope":"row",
          "request":{
            "data":{
              "action":"demo1_prvt.downloadProductImage",
              "args":{
                "productId":"${ds_img.product}"
              }
            }
          }
        }
      ]
    }
  ],
  "parts":[
    {
      "code":"p_main",
      "label":"$l{${@screen.product_name}}l",
      "type":"form",
      "border_type":"none",
      "position":{
        "from_col":1,
        "to_col":4,
        "from_row":1,
        "to_row":4
      },
      "data_source":{
        "code":"ds_img",
        "fields":[
          {
            "code":"img",
            "query":false
          }
        ],
        "operations":[
          "select"
        ],
        "actions":[
          "upload_image",
          "download_image",
          "delete_image"
        ],
        "row_template":"${image_html}\n<script>\nds.getRows().forEach( row=> {\ndata.image_html=\"<img src='data:image/\"+row.format+\";base64,\"+row.img+\"' style='height:500px;width:100%;object-fit:scale-down'>\"\n})\n</script>"
      }
    }
  ]
}