{
  "code":"sc_city:scr@demo1_prvt",
  "label":"$l{City}l",
  "subject":"$l{Demo1}l",
  "sort_order":"Z80",
  "trees":[
    "main_tree"
  ],
  "grid":{
    "base":"screen",
    "cols":4,
    "rows":4
  },
  "data_sources":[
    {
      "code":"ds_country",
      "table_name":"Demo1_Prvt.Country",
      "type":"tree",
      "tree_code":"main_tree",
      "fields":[
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"name",
          "label":"$l{f:7ef07d00d006}l",
          "type":"string",
          "tree_node_type":"name",
          "mandatory":true,
          "hint":"$l{f:7ef07d00d006:d}l"
        }
      ],
      "tree_operations":[
        {
          "delete":{
            "request":{
              "data":{
                "action":"demo1_prvt.deleteById",
                "args":{
                  "id":"${main_tree.current_id}",
                  "tablename":"demo1_prvt.country"
                }
              }
            }
          },
          "from":"",
          "insert":{
            "request":{
              "data":{
                "action":"demo1_prvt.insert",
                "args":{
                  "tablename":"demo1_prvt.country",
                  "fields":"${@all_fields}"
                }
              }
            }
          },
          "new":{
            "request":{
              "data":{
                "action":"demo1_prvt.new",
                "args":{
                  "tablename":"demo1_prvt.country"
                }
              }
            }
          },
          "select":{
            "request":{
              "data":{
                "action":"demo1_prvt.selectList",
                "args":{
                  "filter":[
                    "order by name"
                  ],
                  "tablename":"demo1_prvt.country"
                }
              }
            }
          },
          "update":{
            "request":{
              "data":{
                "action":"demo1_prvt.update",
                "args":{
                  "tablename":"demo1_prvt.country",
                  "fields":"${@all_fields}"
                }
              }
            },
            "freshen":[
              {
                "code":"ds_city",
                "type":"all_rows"
              }
            ]
          }
        }
      ]
    },
    {
      "code":"ds_subcountry",
      "table_name":"Demo1_Prvt.Subcountry",
      "type":"tree",
      "tree_code":"main_tree",
      "tree_parents":[
        "ds_country"
      ],
      "fields":[
        {
          "code":"country",
          "label":"$l{f:7ef07d00e006}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Country"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "hint":"$l{f:7ef07d00e006:d}l"
        },
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"name",
          "label":"$l{f:7ef07d00e008}l",
          "type":"string",
          "tree_node_type":"name",
          "mandatory":true,
          "hint":"$l{f:7ef07d00e008:d}l"
        }
      ],
      "tree_operations":[
        {
          "delete":{
            "request":{
              "data":{
                "action":"demo1_prvt.deleteById",
                "args":{
                  "id":"${main_tree.current_id}",
                  "tablename":"demo1_prvt.subcountry"
                }
              }
            }
          },
          "from":"ds_country",
          "insert":{
            "request":{
              "data":{
                "action":"demo1_prvt.insert",
                "args":{
                  "tablename":"demo1_prvt.subcountry",
                  "fields":"${@all_fields}"
                }
              }
            }
          },
          "new":{
            "request":{
              "data":{
                "action":"demo1_prvt.new",
                "args":{
                  "tablename":"demo1_prvt.subcountry",
                  "fields":{
                    "country":"${main_tree.parent_id}"
                  }
                }
              }
            }
          },
          "select":{
            "request":{
              "data":{
                "action":"demo1_prvt.selectList",
                "args":{
                  "filter":[
                    "country=${main_tree.parent_id}",
                    "order by name"
                  ],
                  "tablename":"demo1_prvt.subcountry"
                }
              },
              "dependencies":[
                "main_tree.parent_id"
              ]
            }
          },
          "update":{
            "request":{
              "data":{
                "action":"demo1_prvt.update",
                "args":{
                  "tablename":"demo1_prvt.subcountry",
                  "fields":"${@all_fields}"
                }
              }
            },
            "freshen":[
              {
                "code":"ds_city",
                "type":"all_rows"
              }
            ]
          }
        }
      ]
    },
    {
      "code":"ds_city",
      "table_name":"Demo1_Prvt.City",
      "type":"table",
      "fields":[
        {
          "code":"country",
          "label":"$l{f:7ef07d00c006}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Country"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "edit_condition":"false",
          "hint":"$l{f:7ef07d00c006:d}l"
        },
        {
          "code":"geonameid",
          "label":"$l{f:7ef07d00c00b}l",
          "type":"string",
          "hint":"$l{f:7ef07d00c00b:d}l"
        },
        {
          "code":"id",
          "type":"string"
        },
        {
          "code":"list_nm",
          "label":"$l{f:7ef07d00c00c}l",
          "type":"string",
          "hint":"$l{f:7ef07d00c00c:d}l"
        },
        {
          "code":"name",
          "label":"$l{f:7ef07d00c00a}l",
          "type":"string",
          "hint":"$l{f:7ef07d00c00a:d}l"
        },
        {
          "code":"subcountry",
          "label":"$l{f:7ef07d00c008}l",
          "type":"ref",
          "ref":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@ref_filter}"
                ],
                "tablename":"Demo1_Prvt.Subcountry"
              },
              "fields":[
                "id",
                "@name"
              ]
            }
          },
          "edit_condition":"false",
          "hint":"$l{f:7ef07d00c008:d}l"
        }
      ],
      "operations":{
        "new":{
          "request":{
            "data":{
              "action":"demo1_prvt.new",
              "args":{
                "tablename":"demo1_prvt.city",
                "fields":{
                  "country":"${main_tree.parent_id}",
                  "subcountry":"${main_tree.current_id}"
                }
              }
            }
          }
        },
        "select":{
          "request":{
            "data":{
              "action":"demo1_prvt.selectList",
              "args":{
                "filter":[
                  "${@user_filter}",
                  "${main_tree.current_id}=subcountry order by name"
                ],
                "tablename":"demo1_prvt.city"
              }
            },
            "dependencies":[
              "main_tree.current_id"
            ]
          }
        },
        "insert":{
          "request":{
            "data":{
              "action":"demo1_prvt.insert",
              "args":{
                "tablename":"demo1_prvt.city",
                "fields":"${@all_fields}"
              }
            }
          }
        },
        "update":{
          "request":{
            "data":{
              "action":"demo1_prvt.update",
              "args":{
                "tablename":"demo1_prvt.city",
                "fields":"${@all_fields}"
              }
            }
          }
        },
        "delete":{
          "request":{
            "data":{
              "action":"demo1_prvt.deleteById",
              "args":{
                "id":"${id}",
                "tablename":"demo1_prvt.city"
              }
            }
          }
        }
      },
      "actions":[
        {
          "code":"testAltCtrl",
          "label":"$l{TestAltCtrl}l",
          "data_scope":"row",
          "request":{
            "data":{
              "action":"demo1_prvt.testAltCtrl",
              "args":{
                "isAltPressed":"${@special.altkey}",
                "isCtrlPressed":"${@special.ctrlkey}"
              }
            }
          }
        }
      ]
    }
  ],
  "parts":[
    {
      "code":"p_tree",
      "type":"tree",
      "tree_code":"main_tree",
      "border_type":"none",
      "position":{
        "from_col":1,
        "to_col":1,
        "from_row":1,
        "to_row":4
      },
      "data_source":{
      }
    },
    {
      "code":"p_city",
      "type":"table",
      "border_type":"none",
      "position":{
        "from_col":2,
        "to_col":4,
        "from_row":1,
        "to_row":4
      },
      "data_source":{
        "code":"ds_city",
        "fields":[
          {
            "code":"country"
          },
          {
            "code":"subcountry"
          },
          {
            "code":"name"
          }
        ],
        "order":[
          {
            "field":"name"
          }
        ],
        "operations":[
          "new",
          "select",
          "insert",
          "update",
          "delete"
        ],
        "actions":[
          "testAltCtrl"
        ]
      },
      "view_condition":"${main_tree.parent_id}!=null"
    }
  ]
}